# Python数据结构-元组

## 1. 元组概述

在 Python 语言中，元组也是多个元素按照一定顺序构成的序列。元组和列表的不同之处在于，**元组是不可变类型**，这就意味着元组类型的变量一旦定义，其中的元素不能再添加或删除，而且元素的值也不能修改。如果试图修改元组中的元素，将引发`TypeError`错误，导致程序崩溃。

## 2. 创建元组

### 2.1 使用字面量语法

定义元组通常使用形如`(x, y, z)`的字面量语法。

```python
# 定义一个三元组
t1 = (35, 12, 98)
# 定义一个四元组
t2 = ('骆昊', 45, True, '四川成都')

# 查看变量的类型
print(type(t1))  # <class 'tuple'>
print(type(t2))  # <class 'tuple'>

# 查看元组中元素的数量
print(len(t1))  # 3
print(len(t2))  # 4
```

### 2.2 空元组和单元素元组

**重要**：`()`表示空元组，但是如果元组中只有一个元素，需要加上一个逗号，否则`()`就不是代表元组的字面量语法，而是改变运算优先级的圆括号。

```python
a = ()
print(type(a))  # <class 'tuple'>

b = ('hello')
print(type(b))  # <class 'str'>（不是元组！）

c = (100)
print(type(c))  # <class 'int'>（不是元组！）

d = ('hello', )  # 注意逗号
print(type(d))  # <class 'tuple'>

e = (100, )  # 注意逗号
print(type(e))  # <class 'tuple'>
```

## 3. 元组的运算

元组类型支持的运算符跟列表是一样的。

### 3.1 索引运算

```python
t1 = (35, 12, 98)
print(t1[0])    # 35
print(t1[2])    # 98
print(t1[-1])   # 98
```

### 3.2 切片运算

```python
t2 = ('骆昊', 45, True, '四川成都')
print(t2[:2])   # ('骆昊', 45)
print(t2[::3])  # ('骆昊', '四川成都')
```

### 3.3 循环遍历

```python
for elem in t1:
    print(elem)
```

### 3.4 成员运算

```python
print(12 in t1)         # True
print(99 in t1)         # False
print('Hao' not in t2)  # True
```

### 3.5 拼接运算

```python
t1 = (35, 12, 98)
t2 = ('骆昊', 45, True)
t3 = t1 + t2
print(t3)  # (35, 12, 98, '骆昊', 45, True)
```

### 3.6 比较运算

```python
t1 = (35, 12, 98)
t2 = (35, 12, 98)
t3 = (35, 11, 99)
print(t1 == t2)  # True
print(t1 <= t3)  # False
```

## 4. 打包和解包操作

### 4.1 打包操作

当我们把多个用逗号分隔的值赋给一个变量时，多个值会打包成一个元组类型。

```python
# 打包操作
a = 1, 10, 100
print(type(a))  # <class 'tuple'>
print(a)        # (1, 10, 100)
```

### 4.2 解包操作

当我们把一个元组赋值给多个变量时，元组会解包成多个值然后分别赋给对应的变量。

```python
# 解包操作
i, j, k = a
print(i, j, k)  # 1 10 100
```

**注意**：在解包时，如果解包出来的元素个数和变量个数不对应，会引发`ValueError`异常。

```python
a = 1, 10, 100, 1000
# i, j, k = a             # ValueError: too many values to unpack (expected 3)
# i, j, k, l, m, n = a    # ValueError: not enough values to unpack (expected 6, got 4)
```

### 4.3 星号表达式

如果变量个数少于元素的个数，可以使用星号表达式。通过星号表达式，我们可以让一个变量接收多个值。

```python
a = 1, 10, 100, 1000
i, j, *k = a
print(i, j, k)        # 1 10 [100, 1000]

i, *j, k = a
print(i, j, k)        # 1 [10, 100] 1000

*i, j, k = a
print(i, j, k)        # [1, 10] 100 1000
```

**说明**：
- 用星号表达式修饰的变量会变成一个列表，列表中有0个或多个元素
- 在解包语法中，星号表达式只能出现一次

### 4.4 解包语法的通用性

解包语法对所有的序列都成立，这就意味着列表、`range`函数构造的范围序列甚至字符串都可以使用解包语法。

```python
a, b, *c = range(1, 10)
print(a, b, c)  # 1 2 [3, 4, 5, 6, 7, 8, 9]

a, b, c = [1, 10, 100]
print(a, b, c)  # 1 10 100

a, *b, c = 'hello'
print(a, b, c)  # h ['e', 'l', 'l'] o
```

## 5. 交换变量的值

交换变量的值是写代码时经常用到的一个操作。在 Python 中，交换两个变量`a`和`b`的值只需要使用如下所示的代码。

```python
a, b = b, a
```

同理，如果要将三个变量`a`、`b`、`c`的值互换，也可以如法炮制。

```python
a, b, c = b, c, a
```

**说明**：上面的操作并没有用到打包和解包语法，Python 的字节码指令中有`ROT_TWO`和`ROT_THREE`这样的指令可以直接实现这个操作，效率是非常高的。但是如果有多于三个变量的值要依次互换，需要通过打包解包的方式来完成。

## 6. 元组和列表的比较

Python 中已经有了列表类型，为什么还需要元组这样的类型呢？

### 6.1 不可变类型的优势

1. **不可变类型更适合多线程环境**：因为它降低了并发访问变量的同步化开销

2. **不可变类型在创建时间上优于对应的可变类型**：

```python
import timeit

print('%.3f 秒' % timeit.timeit('[1, 2, 3, 4, 5, 6, 7, 8, 9]', number=10000000))
print('%.3f 秒' % timeit.timeit('(1, 2, 3, 4, 5, 6, 7, 8, 9)', number=10000000))
```

输出示例：
```
0.635 秒（列表）
0.078 秒（元组）
```

显然创建元组更快且二者时间上有数量级的差别。

### 6.2 类型转换

Python 中的元组和列表类型是可以相互转换的。

```python
infos = ('骆昊', 43, True, '四川成都')
# 将元组转换成列表
print(list(infos))  # ['骆昊', 43, True, '四川成都']

frts = ['apple', 'banana', 'orange']
# 将列表转换成元组
print(tuple(frts))  # ('apple', 'banana', 'orange')
```

## 7. 元组的特点

1. **不可变性**：元组一旦创建，不能修改其元素
2. **有序性**：元组中的元素按照特定顺序排列
3. **可重复**：元组中可以包含重复的元素
4. **异构性**：元组中的元素可以是不同类型

## 8. 元组的应用场景

1. **作为字典的键**：因为元组是不可变类型，可以作为字典的键
2. **函数返回多个值**：函数可以返回一个元组，调用者可以通过解包获取多个返回值
3. **保护数据**：当需要保护数据不被修改时，使用元组
4. **作为集合的元素**：不可变的元组可以作为集合的元素

## 9. 总结

**列表和元组都是容器型的数据类型**，即一个变量可以保存多个数据，而且它们都是按一定顺序组织元素的有序容器。**列表是可变数据类型**，**元组是不可变数据类型**，所以列表可以添加元素、删除元素、清空元素、排序反转，但这些操作对元组来说是不成立的。列表和元组都可以支持**拼接运算**、**成员运算**、**索引运算**、**切片运算**等操作。
