# Python运算符

## 1. 运算符概述

Python 语言支持很多种运算符，下面的表格按照运算符的优先级从高到低，对 Python 中的运算符进行了罗列。

| 运算符 | 描述 |
|--------|------|
| `[]`、`[:]` | 索引、切片 |
| `**` | 幂 |
| `~`、`+`、`-` | 按位取反、正号、负号 |
| `*`、`/`、`%`、`//` | 乘、除、模、整除 |
| `+`、`-` | 加、减 |
| `>>`、`<<` | 右移、左移 |
| `&` | 按位与 |
| `^`、`\|` | 按位异或、按位或 |
| `<=`、`<`、`>`、`>=` | 小于等于、小于、大于、大于等于 |
| `==`、`!=` | 等于、不等于 |
| `is`、`is not` | 身份运算符 |
| `in`、`not in` | 成员运算符 |
| `not`、`or`、`and` | 逻辑运算符 |
| `=`、`+=`、`-=`、`*=`、`/=`、`%=`、`//=`、`**=`、`&=`、`\|=`、`^=`、`>>=`、`<<=` | 赋值运算符 |

> **说明**：所谓优先级就是在一个运算的表达式中，如果出现了多个运算符，应该先执行什么再执行什么的顺序。编写代码的时候，如果搞不清楚一个表达式中运算符的优先级，可以使用圆括号（小括号）来确保运算的执行顺序。

## 2. 算术运算符

Python 中的算术运算符非常丰富，除了大家最为熟悉的加、减、乘、除之外，还有整除运算符、求模（求余数）运算符和求幂运算符。

```python
"""
算术运算符

Version: 1.0
Author: 骆昊
"""
print(321 + 12)     # 加法运算，输出333
print(321 - 12)     # 减法运算，输出309
print(321 * 12)     # 乘法运算，输出3852
print(321 / 12)     # 除法运算，输出26.75
print(321 // 12)    # 整除运算，输出26
print(321 % 12)     # 求模运算，输出9
print(321 ** 12)    # 求幂运算，输出1196906950228928915420617322241
```

### 2.1 算术运算优先级

算术运算需要先乘除后加减，这一点跟数学课本中讲的知识没有区别，也就是说乘除法的运算优先级是高于加减法的。如果还有求幂运算，求幂运算的优先级是高于乘除法的。

```python
"""
算术运算的优先级

Version: 1.0
Author: 骆昊
"""
print(2 + 3 * 5)           # 17
print((2 + 3) * 5)         # 25
print((2 + 3) * 5 ** 2)    # 125
print(((2 + 3) * 5) ** 2)  # 625
```

## 3. 赋值运算符

赋值运算符应该是最为常见的运算符，它的作用是将右边的值赋给左边的变量。

### 3.1 基本赋值

```python
a = 10
b = 20
```

### 3.2 复合赋值运算符

赋值运算符还可以跟算术运算符放在一起，组合成复合赋值运算符。

```python
"""
赋值运算符和复合赋值运算符

Version: 1.0
Author: 骆昊
"""
a = 10
b = 3
a += b        # 相当于：a = a + b
a *= a + 2    # 相当于：a = a * (a + 2)
print(a)      # 169
```

### 3.3 海象运算符（Python 3.8+）

Python 3.8 中引入了一个新的赋值运算符`:=`，我们称之为海象运算符。海象运算符也是将运算符右侧的值赋值给左边的变量，与赋值运算符不同的是，运算符右侧的值也是整个表达式的值。

```python
"""
海象运算符

Version: 1.0
Author: 骆昊
"""
# SyntaxError: invalid syntax
# print((a = 10))

# 海象运算符
print((a := 10))  # 10
print(a)          # 10
```

## 4. 比较运算符

比较运算符也称为关系运算符，包括`==`、`!=`、`<`、`>`、`<=`、`>=`。

```python
a = 10
b = 20
print(a == b)  # False
print(a != b)  # True
print(a < b)   # True
print(a > b)   # False
print(a <= b)  # True
print(a >= b)  # False
```

**注意**：
- 比较相等用的是`==`（两个等号），不是`=`（一个等号是赋值运算符）
- 比较运算符会产生布尔值，要么是`True`，要么是`False`

## 5. 逻辑运算符

逻辑运算符有三个，分别是`and`、`or`和`not`。

### 5.1 and运算符

`and`字面意思是"而且"，所以`and`运算符会连接两个布尔值或者产生布尔值的表达式，如果两边的布尔值都是`True`，那么运算的结果就是`True`；左右两边的布尔值有一个是`False`，最终的运算结果就是`False`。

```python
print(True and True)   # True
print(True and False)  # False
print(False and True)  # False
print(False and False) # False
```

**短路特性**：如果`and`运算符左边的布尔值是`False`，不管右边的布尔值是什么，最终的结果都是`False`，这时运算符右边的布尔值会被跳过（如果`and`右边是一个表达式，那么这个表达式不会执行）。

### 5.2 or运算符

`or`字面意思是"或者"，所以`or`运算符也会连接两个布尔值或产生布尔值的表达式，如果两边的布尔值有任意一个是`True`，那么最终的结果就是`True`。

```python
print(True or True)   # True
print(True or False)  # True
print(False or True)  # True
print(False or False) # False
```

**短路特性**：当`or`运算符左边的布尔值为`True`的情况下，右边的布尔值会被短路（如果`or`右边是一个表达式，那么这个表达式不会执行）。

### 5.3 not运算符

`not`运算符的后面可以跟一个布尔值，如果`not`后面的布尔值或表达式是`True`，那么运算的结果就是`False`；如果`not`后面的布尔值或表达式是`False`，那么运算的结果就是`True`。

```python
print(not True)   # False
print(not False)  # True
```

### 5.4 逻辑运算符示例

```python
"""
比较运算符和逻辑运算符的使用

Version: 1.0
Author: 骆昊
"""
flag0 = 1 == 1
flag1 = 3 > 2
flag2 = 2 < 1
flag3 = flag1 and flag2
flag4 = flag1 or flag2
flag5 = not flag0
print('flag0 =', flag0)     # flag0 = True
print('flag1 =', flag1)     # flag1 = True
print('flag2 =', flag2)     # flag2 = False
print('flag3 =', flag3)     # flag3 = False
print('flag4 =', flag4)     # flag4 = True
print('flag5 =', flag5)     # flag5 = False
print(flag1 and not flag2)  # True
print(1 > 2 or 2 == 3)      # False
```

## 6. 成员运算符

成员运算符用于判断一个值是否在序列中。

```python
items = [1, 2, 3, 4, 5]
print(3 in items)      # True
print(6 in items)      # False
print(3 not in items)  # False
```

## 7. 身份运算符

身份运算符用于比较两个对象的内存地址。

```python
a = [1, 2, 3]
b = [1, 2, 3]
c = a

print(a is b)      # False（不同的对象）
print(a is c)      # True（同一个对象）
print(a == b)      # True（值相等）
print(id(a))       # 查看对象的内存地址
print(id(b))       # 不同的内存地址
```

**注意**：
- `is`比较的是对象的内存地址（身份）
- `==`比较的是对象的值（内容）

## 8. 位运算符

位运算符用于对整数进行位运算。

```python
a = 60  # 60 = 0011 1100
b = 13  # 13 = 0000 1101

print(a & b)   # 12 = 0000 1100（按位与）
print(a | b)   # 61 = 0011 1101（按位或）
print(a ^ b)   # 49 = 0011 0001（按位异或）
print(~a)      # -61（按位取反）
print(a << 2)  # 240 = 1111 0000（左移）
print(a >> 2)  # 15 = 0000 1111（右移）
```

## 9. 运算符应用示例

### 9.1 华氏温度转摄氏温度

```python
"""
将华氏温度转换为摄氏温度

Version: 1.0
Author: 骆昊
"""
f = float(input('请输入华氏温度: '))
c = (f - 32) / 1.8
print(f'{f:.1f}华氏度 = {c:.1f}摄氏度')
```

### 9.2 计算圆的周长和面积

```python
"""
输入半径计算圆的周长和面积

Version: 1.0
Author: 骆昊
"""
import math

radius = float(input('请输入圆的半径: '))
perimeter = 2 * math.pi * radius
area = math.pi * radius ** 2
print(f'周长: {perimeter:.2f}')
print(f'面积: {area:.2f}')
```

### 9.3 判断闰年

```python
"""
输入年份，闰年输出True，平年输出False

Version: 1.0
Author: 骆昊
"""
year = int(input('请输入年份: '))
is_leap = year % 4 == 0 and year % 100 != 0 or year % 400 == 0
print(f'{is_leap = }')
```

**闰年判断规则**：
1. 公元年份非 4 的倍数是平年
2. 公元年份为 4 的倍数但非 100 的倍数是闰年
3. 公元年份为 400 的倍数是闰年

## 10. 运算符优先级总结

1. **最高优先级**：`()`（括号）
2. **次高优先级**：`**`（幂运算）
3. **高优先级**：`*`、`/`、`%`、`//`（乘除模整除）
4. **中优先级**：`+`、`-`（加减）
5. **比较运算符**：`<`、`>`、`<=`、`>=`、`==`、`!=`
6. **逻辑运算符**：`not`、`and`、`or`
7. **最低优先级**：赋值运算符

## 11. 最佳实践

1. **使用括号明确优先级**：当表达式复杂时，使用括号明确运算顺序
2. **理解短路特性**：利用`and`和`or`的短路特性优化代码
3. **区分`is`和`==`**：`is`比较身份，`==`比较值
4. **合理使用复合赋值**：简化代码，提高可读性

## 12. 总结

通过运算符和表达式，我们可以构造各种各样的表达式来解决实际问题。变量、运算符、表达式对于任何一门编程语言都是极为重要的基础。

