# 代码质量工具

> Python 代码质量检查和格式化工具

## 1. 代码格式化

### 1.1 Black

```bash
pip install black
```

```bash
# 格式化文件
black script.py

# 格式化目录
black src/

# 检查格式（不修改）
black --check src/
```

### 1.2 autopep8

```bash
pip install autopep8
```

```bash
# 格式化文件
autopep8 --in-place script.py

# 格式化目录
autopep8 --in-place --recursive src/
```

## 2. 代码检查

### 2.1 Flake8

```bash
pip install flake8
```

```bash
# 检查代码
flake8 script.py

# 忽略特定错误
flake8 --ignore=E501,W503 script.py
```

### 2.2 Pylint

```bash
pip install pylint
```

```bash
# 检查代码
pylint script.py

# 生成报告
pylint --output-format=html script.py > report.html
```

## 3. 类型检查

### 3.1 mypy

```bash
pip install mypy
```

```python
# 添加类型注解
def add(a: int, b: int) -> int:
    return a + b
```

```bash
# 类型检查
mypy script.py
```

## 4. 代码复杂度

### 4.1 Radon

```bash
pip install radon
```

```bash
# 计算复杂度
radon cc script.py

# 计算圈复杂度
radon cc -a script.py
```

## 5. 安全扫描

### 5.1 Bandit

```bash
pip install bandit
```

```bash
# 安全扫描
bandit -r src/

# 生成报告
bandit -r src/ -f json -o report.json
```

## 6. 代码覆盖率

### 6.1 Coverage.py

```bash
pip install coverage
```

```bash
# 运行测试并收集覆盖率
coverage run -m pytest

# 生成报告
coverage report
coverage html
```

## 7. 集成工具

### 7.1 pre-commit

```bash
pip install pre-commit
```

```yaml
# .pre-commit-config.yaml
repos:
  - repo: https://github.com/psf/black
    rev: 23.3.0
    hooks:
      - id: black
  - repo: https://github.com/pycqa/flake8
    rev: 6.0.0
    hooks:
      - id: flake8
```

```bash
# 安装钩子
pre-commit install

# 手动运行
pre-commit run --all-files
```

## 8. 总结

代码质量工具要点：
- **格式化**：Black、autopep8
- **代码检查**：Flake8、Pylint
- **类型检查**：mypy
- **复杂度分析**：Radon
- **安全扫描**：Bandit
- **覆盖率**：Coverage.py
- **集成**：pre-commit

使用这些工具可以保持代码质量和一致性。

